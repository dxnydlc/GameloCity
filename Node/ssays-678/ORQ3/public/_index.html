<html>
	<head>
		<title>Chat Socket.io</title>

	</head>
	<body>
		<h3>SSAYS</h3>

		<div id=" chat-container " >
			<div id=" chat-window ">
				<div id="output"></div>
				<div id="actions"></div>
			</div>
			<input type="text" id="username" placeholder="Usuario prro" >
			<input type="text" id="message"  placeholder="Mensaje prro" >
			<button id="send" >Enviarsh</button>
		</div>


		<script>
			var $idU = 334, $nomU = 'Pepe los palotes', $dniU = '3423242',$moduloU = 'SSSS',$appU = 'Orquesta 0';
		</script>
		<script src="socket.io/socket.io.js" ></script>
		<!--<script src="chat.js" ></script>-->

<script type="text/javascript">


const socket = io('http://localhost:315/');
//const socket = io('https://ssays-orquesta.com:8444/');

// DOM elementos
let message 	= document.getElementById('message');
let username 	= document.getElementById('username');
let send 		= document.getElementById('send');
let output 		= document.getElementById('output');
let actions 	= document.getElementById('actions');


send.addEventListener('click', function(){
	console.log('>>>>>>> mandando chat!');
	socket.emit('chat:message',{
		message: message.value,
		username: username.value,
		dni: $dniU, 'idU': $idU,moduloU:$moduloU,appU:$appU
	});
});

message.addEventListener('keypress',function(){
	socket.emit('chat:typing',username.value);
});

socket.on('chat:message', function( data ){
	actions.innerHTML = '';
	output.innerHTML += `<p>
		<strong>${data.username}</strong> ${data.message}
	</p>`;
});


socket.on('chat:typing', function( data ){
	actions.innerHTML = `<p><em>${data} esta escribiendo...</em></p>`;
});



</script>

	</body>
</html>
